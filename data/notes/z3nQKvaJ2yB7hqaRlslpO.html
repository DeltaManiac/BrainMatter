<h1 id="day-6">Day 6<a aria-hidden="true" class="anchor-heading icon-link" href="#day-6"></a></h1>
<h2 id="probably-a-fire-hazard">Probably a Fire Hazard<a aria-hidden="true" class="anchor-heading icon-link" href="#probably-a-fire-hazard"></a></h2>
<h2 id="part-i">Part I<a aria-hidden="true" class="anchor-heading icon-link" href="#part-i"></a></h2>
<p>Because your neighbors keep defeating you in the holiday house decorating contest year after year, you've decided to deploy one million lights in a 1000x1000 grid.</p>
<p>Furthermore, because you've been especially nice this year, Santa has mailed you instructions on how to display the ideal lighting configuration.</p>
<p>Lights in your grid are numbered from 0 to 999 in each direction; the lights at each corner are at <code>0,0</code>, <code>0,999</code>, <code>999,999</code>, and <code>999,0</code>. The instructions include whether to <code>turn on</code>, <code>turn off</code>, or <code>toggle</code> various inclusive ranges given as coordinate pairs. Each coordinate pair represents opposite corners of a rectangle, inclusive; a coordinate pair like <code>0,0 through 2,2</code> therefore refers to 9 lights in a 3x3 square. The lights all start turned off.</p>
<p>To defeat your neighbors this year, all you have to do is set up your lights by doing the instructions Santa sent you in order.</p>
<p>For example:</p>
<blockquote>
<p><code>turn on 0,0 through 999,999</code> would turn on (or leave on) every light.</p>
<p><code>toggle 0,0 through 999,0</code> would toggle the first line of 1000 lights, turning off the ones that were on, and turning on the ones that were off.</p>
<p><code>turn off 499,499 through 500,500</code> would turn off (or leave off) the middle four lights.</p>
</blockquote>
<p>After following the instructions, how many lights are lit?</p>
<h2 id="solution">Solution<a aria-hidden="true" class="anchor-heading icon-link" href="#solution"></a></h2>
<pre class="language-rust"><code class="language-rust"><span class="token keyword">enum</span> <span class="token type-definition class-name">Action</span> <span class="token punctuation">{</span>
    <span class="token class-name">On</span><span class="token punctuation">,</span>
    <span class="token class-name">Off</span><span class="token punctuation">,</span>
    <span class="token class-name">Toggle</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">Instruction</span> <span class="token punctuation">{</span>
    start<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token keyword">usize</span><span class="token punctuation">,</span> <span class="token keyword">usize</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    end<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token keyword">usize</span><span class="token punctuation">,</span> <span class="token keyword">usize</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    action<span class="token punctuation">:</span> <span class="token class-name">Action</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[aoc_generator(day6)]</span>
<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">input_to_struct</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&#x26;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">Vec</span><span class="token operator">&#x3C;</span><span class="token class-name">Instruction</span><span class="token operator">></span> <span class="token punctuation">{</span>
    input
        <span class="token punctuation">.</span><span class="token function">lines</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>line<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> <span class="token keyword">mut</span> c <span class="token operator">=</span> line<span class="token punctuation">.</span><span class="token function">split_whitespace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rev</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> <span class="token keyword">mut</span> d <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token char">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> end <span class="token operator">=</span> <span class="token punctuation">(</span>
                d<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&#x3C;</span><span class="token keyword">usize</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                d<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&#x3C;</span><span class="token keyword">usize</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
            c<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> <span class="token keyword">mut</span> d <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token char">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> start <span class="token operator">=</span> <span class="token punctuation">(</span>
                d<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&#x3C;</span><span class="token keyword">usize</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                d<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&#x3C;</span><span class="token keyword">usize</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> action <span class="token operator">=</span> <span class="token keyword">match</span> c<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token string">"on"</span> <span class="token operator">=></span> <span class="token class-name">Action</span><span class="token punctuation">::</span><span class="token class-name">On</span><span class="token punctuation">,</span>
                <span class="token string">"off"</span> <span class="token operator">=></span> <span class="token class-name">Action</span><span class="token punctuation">::</span><span class="token class-name">Off</span><span class="token punctuation">,</span>
                <span class="token string">"toggle"</span> <span class="token operator">=></span> <span class="token class-name">Action</span><span class="token punctuation">::</span><span class="token class-name">Toggle</span><span class="token punctuation">,</span>
                _ <span class="token operator">=></span> <span class="token macro property">unreachable!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>

            <span class="token class-name">Instruction</span> <span class="token punctuation">{</span>
                start<span class="token punctuation">:</span> start<span class="token punctuation">,</span>
                end<span class="token punctuation">:</span> end<span class="token punctuation">,</span>
                action<span class="token punctuation">:</span> action<span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&#x3C;</span><span class="token class-name">Vec</span><span class="token operator">&#x3C;</span><span class="token class-name">Instruction</span><span class="token operator">>></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[aoc(day6, part1)]</span>
<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">part1</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&#x26;</span><span class="token class-name">Vec</span><span class="token operator">&#x3C;</span><span class="token class-name">Instruction</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">i64</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> switch<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">;</span> <span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token number">1000</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> count<span class="token punctuation">:</span> <span class="token keyword">i64</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> input <span class="token punctuation">{</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> x<span class="token punctuation">.</span>start<span class="token number">.0</span><span class="token punctuation">..=</span>x<span class="token punctuation">.</span>end<span class="token number">.0</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> x<span class="token punctuation">.</span>start<span class="token number">.1</span><span class="token punctuation">..=</span>x<span class="token punctuation">.</span>end<span class="token number">.1</span> <span class="token punctuation">{</span>
                <span class="token keyword">match</span> x<span class="token punctuation">.</span>action <span class="token punctuation">{</span>
                    <span class="token class-name">Action</span><span class="token punctuation">::</span><span class="token class-name">Off</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
                        <span class="token keyword">if</span> switch<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">{</span>
                            count <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                            switch<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                    <span class="token class-name">Action</span><span class="token punctuation">::</span><span class="token class-name">On</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
                        <span class="token keyword">if</span> switch<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
                            count <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                            switch<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                    <span class="token class-name">Action</span><span class="token punctuation">::</span><span class="token class-name">Toggle</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
                        <span class="token keyword">if</span> switch<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
                            count <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                            switch<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                            count <span class="token operator">+=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
                            switch<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    count
<span class="token punctuation">}</span>
</code></pre>
<h2 id="part-ii">Part II<a aria-hidden="true" class="anchor-heading icon-link" href="#part-ii"></a></h2>
<p>You just finish implementing your winning light pattern when you realize you mistranslated Santa's message from Ancient Nordic Elvish.</p>
<p>The light grid you bought actually has individual brightness controls; each light can have a brightness of zero or more. The lights all start at zero.</p>
<p>The phrase <code>turn on</code> actually means that you should increase the brightness of those lights by <code>1</code>.</p>
<p>The phrase <code>turn off</code> actually means that you should decrease the brightness of those lights by <code>1</code>, to a minimum of zero.</p>
<p>The phrase toggle actually means that you should increase the brightness of those lights by <code>2</code>.</p>
<p>What is the total brightness of all lights combined after following Santa's instructions?</p>
<p>For example:</p>
<blockquote>
<p><code>turn on 0,0 through 0,0</code> would increase the total brightness by <code>1</code>.</p>
<p><code>toggle 0,0 through 999,999</code> would increase the total brightness by <code>2000000</code>.</p>
</blockquote>
<h2 id="solution-1">Solution<a aria-hidden="true" class="anchor-heading icon-link" href="#solution-1"></a></h2>
<pre class="language-rust"><code class="language-rust"><span class="token attribute attr-name">#[aoc(day6, part2)]</span>
<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">part2</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&#x26;</span><span class="token class-name">Vec</span><span class="token operator">&#x3C;</span><span class="token class-name">Instruction</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">i64</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> switch<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token keyword">i16</span><span class="token punctuation">;</span> <span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token number">1000</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> bright<span class="token punctuation">:</span> <span class="token keyword">i64</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> input <span class="token punctuation">{</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> x<span class="token punctuation">.</span>start<span class="token number">.0</span><span class="token punctuation">..=</span>x<span class="token punctuation">.</span>end<span class="token number">.0</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> x<span class="token punctuation">.</span>start<span class="token number">.1</span><span class="token punctuation">..=</span>x<span class="token punctuation">.</span>end<span class="token number">.1</span> <span class="token punctuation">{</span>
                <span class="token keyword">match</span> x<span class="token punctuation">.</span>action <span class="token punctuation">{</span>
                    <span class="token class-name">Action</span><span class="token punctuation">::</span><span class="token class-name">Off</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
                        <span class="token keyword">if</span> switch<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">{</span>
                            bright <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                            switch<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                    <span class="token class-name">Action</span><span class="token punctuation">::</span><span class="token class-name">On</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
                        bright <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                        switch<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token class-name">Action</span><span class="token punctuation">::</span><span class="token class-name">Toggle</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
                        bright <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
                        switch<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    bright
<span class="token punctuation">}</span>
</code></pre>