<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/favicon.ico"/><title>Gokit</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal knowledge space"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="delta_maniac"/><meta name="twitter:creator" content="delta_maniac"/><meta property="og:title" content="Gokit"/><meta property="og:description" content="Personal knowledge space"/><meta property="og:url" content="https://deltamaniac.github.io//notes/QNZTT1U9ZBung828xTuQz/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="10/17/2020"/><meta property="article:modified_time" content="10/17/2020"/><link rel="canonical" href="https://deltamaniac.github.io//notes/QNZTT1U9ZBung828xTuQz/"/><meta name="next-head-count" content="17"/><link rel="preload" href="/_next/static/css/8e7b7e4bce421c0a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8e7b7e4bce421c0a.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-3d209faeb64f2f97.js" defer=""></script><script src="/_next/static/chunks/framework-28c999baf2863c3d.js" defer=""></script><script src="/_next/static/chunks/main-104451f3d1a5c4bc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-9d8e0603730b15a3.js" defer=""></script><script src="/_next/static/chunks/935-4dee79e80b8641c6.js" defer=""></script><script src="/_next/static/chunks/6-50972def09142ee2.js" defer=""></script><script src="/_next/static/chunks/pages/notes/%5Bid%5D-78d472fa3b924116.js" defer=""></script><script src="/_next/static/uwaFLQSct0mTPwxN4Nqr7/_buildManifest.js" defer=""></script><script src="/_next/static/uwaFLQSct0mTPwxN4Nqr7/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><main class="ant-layout-content side-layout-main" style="max-width:1200px;min-width:0;display:block"><div style="padding:0 24px"><div class="main-content" role="main"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="gokit">Gokit<a aria-hidden="true" class="anchor-heading icon-link" href="#gokit"></a></h1>
<h2 id="gokit-1">Gokit<a aria-hidden="true" class="anchor-heading icon-link" href="#gokit-1"></a></h2>
<p>Spring boot like framework for <a href="/notes/96Hj5nYpnUciwlTenFpoU">Go</a>. It has 3 major Components</p>
<h2 id="service-layer">Service Layer<a aria-hidden="true" class="anchor-heading icon-link" href="#service-layer"></a></h2>
<ul>
<li>Innermost layer where business logic resides.</li>
<li>Modeled as services</li>
<li>Oblivious to Endpoint/Transport Layers</li>
<li>Can be used by multiple Transports (grpc/json/http)</li>
</ul>
<h2 id="endpoint-layer">Endpoint Layer<a aria-hidden="true" class="anchor-heading icon-link" href="#endpoint-layer"></a></h2>
<ul>
<li>Represents a single RPC Method</li>
<li>Service exposed as an Endpoint</li>
<li>Endpoint can be exposed by multiple Transports</li>
</ul>
<h2 id="transport-layer">Transport Layer<a aria-hidden="true" class="anchor-heading icon-link" href="#transport-layer"></a></h2>
<ul>
<li>Exposes various Transports
<ul>
<li>grpc</li>
<li>http</li>
</ul>
</li>
</ul>
<h1 id="building-a-pastebin-clone">Building a <code>pastebin</code> clone<a aria-hidden="true" class="anchor-heading icon-link" href="#building-a-pastebin-clone"></a></h1>
<h2 id="define-a-service-blueprint-interface">Define a service blueprint interface<a aria-hidden="true" class="anchor-heading icon-link" href="#define-a-service-blueprint-interface"></a></h2>
<pre class="language-go"><code class="language-go"><span class="token comment">// PbService provides storage capabilities</span>
<span class="token keyword">type</span> PbService <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">Create</span><span class="token punctuation">(</span>content <span class="token builtin">string</span><span class="token punctuation">,</span> ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
	<span class="token function">Delete</span><span class="token punctuation">(</span>key <span class="token builtin">string</span><span class="token punctuation">,</span> ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
	<span class="token function">Get</span><span class="token punctuation">(</span>key <span class="token builtin">string</span><span class="token punctuation">,</span> ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="make-a-new-struct-to-define-the-pastebin-service">Make a new struct to define the PasteBin Service<a aria-hidden="true" class="anchor-heading icon-link" href="#make-a-new-struct-to-define-the-pastebin-service"></a></h2>
<p>This struct is used to group together the functionalities of pastebin service</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">type</span> pbService <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	memory <span class="token keyword">map</span><span class="token punctuation">[</span>uuid<span class="token punctuation">.</span>UUID<span class="token punctuation">]</span><span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token comment">// NewPbService make a new PbService</span>
<span class="token keyword">func</span> <span class="token function">NewPbService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> PbService <span class="token punctuation">{</span>
	<span class="token keyword">return</span> pbService<span class="token punctuation">{</span>
		memory<span class="token punctuation">:</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span>uuid<span class="token punctuation">.</span>UUID<span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="implement-the-pbservice-interface-on-the-struct">Implement the PbService Interface on the struct<a aria-hidden="true" class="anchor-heading icon-link" href="#implement-the-pbservice-interface-on-the-struct"></a></h2>
<p>In <a href="/notes/96Hj5nYpnUciwlTenFpoU">Go</a> we do not have a key word to define that this structs implements a specific interface like the <code>implements</code> in Java.</p>
<p>They way we enforce contracts is by implementing all the methods of the contract interface in our case here its the <code>PbService</code> interface.</p>
<p>Since our <code>NewPbService</code> method returns the type of <code>PbService</code> the go compiler will ensure that <code>NewPbService</code> confirms to the <code>PbService</code> interface.</p>
<pre class="language-go"><code class="language-go"><span class="token comment">//Create: Here we store the content and return a uuid</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s pbService<span class="token punctuation">)</span> <span class="token function">Create</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> content <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	id <span class="token operator">:=</span> uuid<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	s<span class="token punctuation">.</span>memory<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> content
	<span class="token keyword">return</span> id<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token comment">//Delete: Here we use the key to find and delete the content stored</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s pbService<span class="token punctuation">)</span> <span class="token function">Delete</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> key <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	id<span class="token punctuation">,</span> err <span class="token operator">:=</span> uuid<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"Invalid Uuid Format"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token function">delete</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>memory<span class="token punctuation">,</span> id<span class="token punctuation">)</span>
	<span class="token keyword">return</span> <span class="token string">"ok"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token comment">//Get: Here we use the key to find and return the content stored</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s pbService<span class="token punctuation">)</span> <span class="token function">Get</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> key <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	id<span class="token punctuation">,</span> err <span class="token operator">:=</span> uuid<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"Invalid Uuid Format"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	content<span class="token punctuation">,</span> exists <span class="token operator">:=</span> s<span class="token punctuation">.</span>memory<span class="token punctuation">[</span>id<span class="token punctuation">]</span>
	<span class="token keyword">if</span> exists <span class="token punctuation">{</span>
		<span class="token keyword">return</span> content<span class="token punctuation">,</span> <span class="token boolean">nil</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"Invalid Uuid"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="request-and-response">Request and Response<a aria-hidden="true" class="anchor-heading icon-link" href="#request-and-response"></a></h2>
<p>In Go kit, the primary messaging pattern is RPC.</p>
<p>So, every method in our interface will be modeled as a remote procedure call. For each method, we define request and response structs, capturing all of the input and output parameters respectively.</p>
<h3 id="create-request-response">Create Request Response<a aria-hidden="true" class="anchor-heading icon-link" href="#create-request-response"></a></h3>
<pre class="language-go"><code class="language-go"><span class="token keyword">type</span> createPbRequest <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	content <span class="token builtin">string</span> <span class="token string">`json:"content"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> createPbResponse <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	key <span class="token builtin">string</span> <span class="token string">`json:"key"`</span>
	Err <span class="token builtin">string</span> <span class="token string">`json:"err,omitempty"`</span> <span class="token comment">// errors don't JSON-marshal, so we use a string</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="delete-request-response">Delete Request Response<a aria-hidden="true" class="anchor-heading icon-link" href="#delete-request-response"></a></h3>
<pre class="language-go"><code class="language-go"><span class="token keyword">type</span> deletePbRequest <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	key <span class="token builtin">string</span> <span class="token string">`json:"key"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> deletePbResponse <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	status <span class="token builtin">string</span> <span class="token string">`json:"status"`</span>
	Err    <span class="token builtin">string</span> <span class="token string">`json:"err,omitempty"`</span> <span class="token comment">// errors don't JSON-marshal, so we use a string</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="get-request-response">Get Request Response<a aria-hidden="true" class="anchor-heading icon-link" href="#get-request-response"></a></h3>
<pre class="language-go"><code class="language-go"><span class="token keyword">type</span> getPbRequest <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	key <span class="token builtin">string</span> <span class="token string">`json:"key"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> getPbResponse <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	content <span class="token builtin">string</span> <span class="token string">`json:"content"`</span>
	Err     <span class="token builtin">string</span> <span class="token string">`json:"err,omitempty"`</span> <span class="token comment">// errors don't JSON-marshal, so we use a string</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="define-endpoints">Define Endpoints<a aria-hidden="true" class="anchor-heading icon-link" href="#define-endpoints"></a></h2>
<p>An endpoint represents a single RPC, which is a single method in our service.</p>
<h3 id="create-endpoint">Create Endpoint<a aria-hidden="true" class="anchor-heading icon-link" href="#create-endpoint"></a></h3>
<pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">createPbEndpoint</span><span class="token punctuation">(</span>svc PbService<span class="token punctuation">)</span> endpoint<span class="token punctuation">.</span>Endpoint <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> request <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		req <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token punctuation">(</span>createPbRequest<span class="token punctuation">)</span>
		key<span class="token punctuation">,</span> err <span class="token operator">:=</span> svc<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> req<span class="token punctuation">.</span>Content<span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> createPbResponse<span class="token punctuation">{</span>key<span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> createPbResponse<span class="token punctuation">{</span>key<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="delete-endpoint">Delete Endpoint<a aria-hidden="true" class="anchor-heading icon-link" href="#delete-endpoint"></a></h3>
<pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">deletePbEndpoint</span><span class="token punctuation">(</span>svc PbService<span class="token punctuation">)</span> endpoint<span class="token punctuation">.</span>Endpoint <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> request <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		req <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token punctuation">(</span>deletePbRequest<span class="token punctuation">)</span>
		status<span class="token punctuation">,</span> err <span class="token operator">:=</span> svc<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> req<span class="token punctuation">.</span>Key<span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> deletePbResponse<span class="token punctuation">{</span>status<span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> deletePbResponse<span class="token punctuation">{</span>status<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="get-endpoint">Get Endpoint<a aria-hidden="true" class="anchor-heading icon-link" href="#get-endpoint"></a></h3>
<pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">getPbEndpoint</span><span class="token punctuation">(</span>svc PbService<span class="token punctuation">)</span> endpoint<span class="token punctuation">.</span>Endpoint <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> request <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		req <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token punctuation">(</span>getPbRequest<span class="token punctuation">)</span>
		content<span class="token punctuation">,</span> err <span class="token operator">:=</span> svc<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> req<span class="token punctuation">.</span>Key<span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> getPbResponse<span class="token punctuation">{</span>content<span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> getPbResponse<span class="token punctuation">{</span>content<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="define-transport">Define Transport<a aria-hidden="true" class="anchor-heading icon-link" href="#define-transport"></a></h2>
<p>Since this trivial example used JSON over HTTP we would have to decode the JSON to structs that our service can understand</p>
<h3 id="create-requester-decoder">Create Requester Decoder<a aria-hidden="true" class="anchor-heading icon-link" href="#create-requester-decoder"></a></h3>
<pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">decodeCreatePbRequest</span><span class="token punctuation">(</span><span class="token boolean">_</span> context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> request createPbRequest
	<span class="token keyword">if</span> err <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">NewDecoder</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>Body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Decode</span><span class="token punctuation">(</span><span class="token operator">&#x26;</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> request<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="delete-request-decoder">Delete Request Decoder<a aria-hidden="true" class="anchor-heading icon-link" href="#delete-request-decoder"></a></h3>
<pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">decodeDeletePbRequest</span><span class="token punctuation">(</span><span class="token boolean">_</span> context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> request deletePbRequest
	<span class="token keyword">if</span> err <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">NewDecoder</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>Body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Decode</span><span class="token punctuation">(</span><span class="token operator">&#x26;</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> request<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="get-request-decoder">Get Request Decoder<a aria-hidden="true" class="anchor-heading icon-link" href="#get-request-decoder"></a></h3>
<pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">decodeGetPbRequest</span><span class="token punctuation">(</span><span class="token boolean">_</span> context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> request getPbRequest
	<span class="token keyword">if</span> err <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">NewDecoder</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>Body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Decode</span><span class="token punctuation">(</span><span class="token operator">&#x26;</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> request<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="response-encoder">Response Encoder<a aria-hidden="true" class="anchor-heading icon-link" href="#response-encoder"></a></h3>
<p>This method would accept an <code>interface</code> type and convert it JSON, this allows it to accept <code>createPbResponse</code>,<code>deletePbResponse</code>,<code>getPbResponse</code> as an <code>interface{}</code> and encode it as json using the annotations in the struct definition.</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">encodeResponse</span><span class="token punctuation">(</span><span class="token boolean">_</span> context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> response <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> json<span class="token punctuation">.</span><span class="token function">NewEncoder</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Encode</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="main">Main<a aria-hidden="true" class="anchor-heading icon-link" href="#main"></a></h2>
<pre class="language-go"><code class="language-go"><span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"context"</span>
	<span class="token string">"encoding/json"</span>
	<span class="token string">"errors"</span>
	<span class="token string">"log"</span>
	<span class="token string">"net/http"</span>

	<span class="token string">"github.com/go-kit/kit/endpoint"</span>
	<span class="token string">"github.com/google/uuid"</span>

	httptransport <span class="token string">"github.com/go-kit/kit/transport/http"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	svc <span class="token operator">:=</span> <span class="token function">NewPbService</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	createPbHandler <span class="token operator">:=</span> httptransport<span class="token punctuation">.</span><span class="token function">NewServer</span><span class="token punctuation">(</span>
		<span class="token function">createPbEndpoint</span><span class="token punctuation">(</span>svc<span class="token punctuation">)</span><span class="token punctuation">,</span>
		decodeCreatePbRequest<span class="token punctuation">,</span>
		encodeResponse<span class="token punctuation">,</span>
	<span class="token punctuation">)</span>

	deletePbHandler <span class="token operator">:=</span> httptransport<span class="token punctuation">.</span><span class="token function">NewServer</span><span class="token punctuation">(</span>
		<span class="token function">deletePbEndpoint</span><span class="token punctuation">(</span>svc<span class="token punctuation">)</span><span class="token punctuation">,</span>
		decodeDeletePbRequest<span class="token punctuation">,</span>
		encodeResponse<span class="token punctuation">,</span>
	<span class="token punctuation">)</span>

	getPbHandler <span class="token operator">:=</span> httptransport<span class="token punctuation">.</span><span class="token function">NewServer</span><span class="token punctuation">(</span>
		<span class="token function">getPbEndpoint</span><span class="token punctuation">(</span>svc<span class="token punctuation">)</span><span class="token punctuation">,</span>
		decodeGetPbRequest<span class="token punctuation">,</span>
		encodeResponse<span class="token punctuation">,</span>
	<span class="token punctuation">)</span>

	http<span class="token punctuation">.</span><span class="token function">Handle</span><span class="token punctuation">(</span><span class="token string">"/create"</span><span class="token punctuation">,</span> createPbHandler<span class="token punctuation">)</span>
	http<span class="token punctuation">.</span><span class="token function">Handle</span><span class="token punctuation">(</span><span class="token string">"/delete"</span><span class="token punctuation">,</span> deletePbHandler<span class="token punctuation">)</span>
	http<span class="token punctuation">.</span><span class="token function">Handle</span><span class="token punctuation">(</span><span class="token string">"/get"</span><span class="token punctuation">,</span> getPbHandler<span class="token punctuation">)</span>
	log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="divide-and-conquer">Divide and Conquer<a aria-hidden="true" class="anchor-heading icon-link" href="#divide-and-conquer"></a></h2>
<p>At this point the <code>main.go</code> has a lot of code so lets move to different files so that we have separation of concerns.</p>
<h3 id="servicego"><code>service.go</code><a aria-hidden="true" class="anchor-heading icon-link" href="#servicego"></a></h3>
<pre class="language-go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"context"</span>
	<span class="token string">"errors"</span>

	<span class="token string">"github.com/google/uuid"</span>
<span class="token punctuation">)</span>

<span class="token comment">// PbService provides storage capabilities</span>
<span class="token keyword">type</span> PbService <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">Create</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> content <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
	<span class="token function">Delete</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> key <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
	<span class="token function">Get</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> key <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> pbService <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	memory <span class="token keyword">map</span><span class="token punctuation">[</span>uuid<span class="token punctuation">.</span>UUID<span class="token punctuation">]</span><span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token comment">// NewPbService make a new PbService</span>
<span class="token keyword">func</span> <span class="token function">NewPbService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> PbService <span class="token punctuation">{</span>
	<span class="token keyword">return</span> pbService<span class="token punctuation">{</span>
		memory<span class="token punctuation">:</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span>uuid<span class="token punctuation">.</span>UUID<span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//Create: Here we store the content and return a uuid</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s pbService<span class="token punctuation">)</span> <span class="token function">Create</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> content <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	id <span class="token operator">:=</span> uuid<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	s<span class="token punctuation">.</span>memory<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> content
	<span class="token keyword">return</span> id<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token comment">//Get: Here we use the key to find and return the content stored</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s pbService<span class="token punctuation">)</span> <span class="token function">Get</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> key <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	id<span class="token punctuation">,</span> err <span class="token operator">:=</span> uuid<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"Invalid Uuid Format"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	content<span class="token punctuation">,</span> exists <span class="token operator">:=</span> s<span class="token punctuation">.</span>memory<span class="token punctuation">[</span>id<span class="token punctuation">]</span>
	<span class="token keyword">if</span> exists <span class="token punctuation">{</span>
		<span class="token keyword">return</span> content<span class="token punctuation">,</span> <span class="token boolean">nil</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"Invalid Uuid"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//Delete: Here we use the key to find and delete the content stored</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s pbService<span class="token punctuation">)</span> <span class="token function">Delete</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> key <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	id<span class="token punctuation">,</span> err <span class="token operator">:=</span> uuid<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"Invalid Uuid Format"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token function">delete</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>memory<span class="token punctuation">,</span> id<span class="token punctuation">)</span>
	<span class="token keyword">return</span> <span class="token string">"ok"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="transportgo"><code>transport.go</code><a aria-hidden="true" class="anchor-heading icon-link" href="#transportgo"></a></h3>
<pre class="language-go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"context"</span>
	<span class="token string">"encoding/json"</span>
	<span class="token string">"net/http"</span>

	<span class="token string">"github.com/go-kit/kit/endpoint"</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> createPbRequest <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Content <span class="token builtin">string</span> <span class="token string">`json:"content"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> createPbResponse <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Key <span class="token builtin">string</span> <span class="token string">`json:"key"`</span>
	Err <span class="token builtin">string</span> <span class="token string">`json:"err,omitempty"`</span> <span class="token comment">// errors don't JSON-marshal, so we use a string</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> getPbRequest <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Key <span class="token builtin">string</span> <span class="token string">`json:"key"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> getPbResponse <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Content <span class="token builtin">string</span> <span class="token string">`json:"content"`</span>
	Err     <span class="token builtin">string</span> <span class="token string">`json:"err,omitempty"`</span> <span class="token comment">// errors don't JSON-marshal, so we use a string</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> deletePbRequest <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Key <span class="token builtin">string</span> <span class="token string">`json:"key"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> deletePbResponse <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Status <span class="token builtin">string</span> <span class="token string">`json:"status"`</span>
	Err    <span class="token builtin">string</span> <span class="token string">`json:"err,omitempty"`</span> <span class="token comment">// errors don't JSON-marshal, so we use a string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">createPbEndpoint</span><span class="token punctuation">(</span>svc PbService<span class="token punctuation">)</span> endpoint<span class="token punctuation">.</span>Endpoint <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> request <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		req <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token punctuation">(</span>createPbRequest<span class="token punctuation">)</span>
		key<span class="token punctuation">,</span> err <span class="token operator">:=</span> svc<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> req<span class="token punctuation">.</span>Content<span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> createPbResponse<span class="token punctuation">{</span>key<span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> createPbResponse<span class="token punctuation">{</span>key<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">deletePbEndpoint</span><span class="token punctuation">(</span>svc PbService<span class="token punctuation">)</span> endpoint<span class="token punctuation">.</span>Endpoint <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> request <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		req <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token punctuation">(</span>deletePbRequest<span class="token punctuation">)</span>
		status<span class="token punctuation">,</span> err <span class="token operator">:=</span> svc<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> req<span class="token punctuation">.</span>Key<span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> deletePbResponse<span class="token punctuation">{</span>status<span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> deletePbResponse<span class="token punctuation">{</span>status<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">getPbEndpoint</span><span class="token punctuation">(</span>svc PbService<span class="token punctuation">)</span> endpoint<span class="token punctuation">.</span>Endpoint <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> request <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		req <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token punctuation">(</span>getPbRequest<span class="token punctuation">)</span>
		content<span class="token punctuation">,</span> err <span class="token operator">:=</span> svc<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> req<span class="token punctuation">.</span>Key<span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> getPbResponse<span class="token punctuation">{</span>content<span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> getPbResponse<span class="token punctuation">{</span>content<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">decodeCreatePbRequest</span><span class="token punctuation">(</span><span class="token boolean">_</span> context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> request createPbRequest
	<span class="token keyword">if</span> err <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">NewDecoder</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>Body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Decode</span><span class="token punctuation">(</span><span class="token operator">&#x26;</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> request<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">decodeGetPbRequest</span><span class="token punctuation">(</span><span class="token boolean">_</span> context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> request getPbRequest
	<span class="token keyword">if</span> err <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">NewDecoder</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>Body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Decode</span><span class="token punctuation">(</span><span class="token operator">&#x26;</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> request<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">decodeDeletePbRequest</span><span class="token punctuation">(</span><span class="token boolean">_</span> context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> request deletePbRequest
	<span class="token keyword">if</span> err <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">NewDecoder</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>Body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Decode</span><span class="token punctuation">(</span><span class="token operator">&#x26;</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> request<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="maingo"><code>main.go</code><a aria-hidden="true" class="anchor-heading icon-link" href="#maingo"></a></h3>
<pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	svc <span class="token operator">:=</span> <span class="token function">NewPbService</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	createPbHandler <span class="token operator">:=</span> httptransport<span class="token punctuation">.</span><span class="token function">NewServer</span><span class="token punctuation">(</span>
		<span class="token function">createPbEndpoint</span><span class="token punctuation">(</span>svc<span class="token punctuation">)</span><span class="token punctuation">,</span>
		decodeCreatePbRequest<span class="token punctuation">,</span>
		encodeResponse<span class="token punctuation">,</span>
	<span class="token punctuation">)</span>

	deletePbHandler <span class="token operator">:=</span> httptransport<span class="token punctuation">.</span><span class="token function">NewServer</span><span class="token punctuation">(</span>
		<span class="token function">deletePbEndpoint</span><span class="token punctuation">(</span>svc<span class="token punctuation">)</span><span class="token punctuation">,</span>
		decodeDeletePbRequest<span class="token punctuation">,</span>
		encodeResponse<span class="token punctuation">,</span>
	<span class="token punctuation">)</span>
	getPbHandler <span class="token operator">:=</span> httptransport<span class="token punctuation">.</span><span class="token function">NewServer</span><span class="token punctuation">(</span>
		<span class="token function">getPbEndpoint</span><span class="token punctuation">(</span>svc<span class="token punctuation">)</span><span class="token punctuation">,</span>
		decodeGetPbRequest<span class="token punctuation">,</span>
		encodeResponse<span class="token punctuation">,</span>
	<span class="token punctuation">)</span>
	http<span class="token punctuation">.</span><span class="token function">Handle</span><span class="token punctuation">(</span><span class="token string">"/create"</span><span class="token punctuation">,</span> createPbHandler<span class="token punctuation">)</span>
	http<span class="token punctuation">.</span><span class="token function">Handle</span><span class="token punctuation">(</span><span class="token string">"/delete"</span><span class="token punctuation">,</span> deletePbHandler<span class="token punctuation">)</span>
	http<span class="token punctuation">.</span><span class="token function">Handle</span><span class="token punctuation">(</span><span class="token string">"/get"</span><span class="token punctuation">,</span> getPbHandler<span class="token punctuation">)</span>
	log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="logging-middleware">Logging Middleware<a aria-hidden="true" class="anchor-heading icon-link" href="#logging-middleware"></a></h2>
<p>All applications need to log information, this can be enabled by adding a logging middleware that we create in a file called <code>logging.go</code></p>
<p>Middleware in go-kit work on <code>Endpoint</code></p>
<p>The interface definition is <code>type Middleware func(Endpoint) Endpoint</code>, which means it is a function that takes in an endpoint and returns an endpoint</p>
<p>We can create the <code>loggingMiddleware</code> so that it adheres to the <code>PbService</code> by implementing the <code>Create</code> <code>Delete</code> <code>Get</code> methods.</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">type</span> loggingMiddleware <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	logger log<span class="token punctuation">.</span>Logger
	next   PbService
<span class="token punctuation">}</span>
</code></pre>
<h3 id="create">Create<a aria-hidden="true" class="anchor-heading icon-link" href="#create"></a></h3>
<pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>m loggingMiddleware<span class="token punctuation">)</span> <span class="token function">Create</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> content <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>output <span class="token builtin">string</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// This defered function would be invoked just before the retuen statement</span>
	<span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span>begin time<span class="token punctuation">.</span>Time<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		m<span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>
			<span class="token string">"method"</span><span class="token punctuation">,</span> <span class="token string">"CreatePb"</span><span class="token punctuation">,</span>
			<span class="token string">"input"</span><span class="token punctuation">,</span> content<span class="token punctuation">,</span>
			<span class="token string">"output"</span><span class="token punctuation">,</span> output<span class="token punctuation">,</span>
			<span class="token string">"err"</span><span class="token punctuation">,</span> err<span class="token punctuation">,</span>
			<span class="token string">"took"</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span><span class="token function">Since</span><span class="token punctuation">(</span>begin<span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	output<span class="token punctuation">,</span> err <span class="token operator">=</span> m<span class="token punctuation">.</span>next<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> content<span class="token punctuation">)</span>
	<span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="delete">Delete<a aria-hidden="true" class="anchor-heading icon-link" href="#delete"></a></h3>
<pre class="language-go"><code class="language-go"> <span class="token keyword">func</span> <span class="token punctuation">(</span>m loggingMiddleware<span class="token punctuation">)</span> <span class="token function">Delete</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> key <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>output <span class="token builtin">string</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span>begin time<span class="token punctuation">.</span>Time<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		m<span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>
			<span class="token string">"method"</span><span class="token punctuation">,</span> <span class="token string">"DeletePb"</span><span class="token punctuation">,</span>
			<span class="token string">"input"</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span>
			<span class="token string">"output"</span><span class="token punctuation">,</span> output<span class="token punctuation">,</span>
			<span class="token string">"err"</span><span class="token punctuation">,</span> err<span class="token punctuation">,</span>
			<span class="token string">"took"</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span><span class="token function">Since</span><span class="token punctuation">(</span>begin<span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	output<span class="token punctuation">,</span> err <span class="token operator">=</span> m<span class="token punctuation">.</span>next<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
	<span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="get">Get<a aria-hidden="true" class="anchor-heading icon-link" href="#get"></a></h3>
<pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>m loggingMiddleware<span class="token punctuation">)</span> <span class="token function">Get</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> key <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>output <span class="token builtin">string</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span>begin time<span class="token punctuation">.</span>Time<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		m<span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>
			<span class="token string">"method"</span><span class="token punctuation">,</span> <span class="token string">"GetPb"</span><span class="token punctuation">,</span>
			<span class="token string">"input"</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span>
			<span class="token string">"output"</span><span class="token punctuation">,</span> output<span class="token punctuation">,</span>
			<span class="token string">"err"</span><span class="token punctuation">,</span> err<span class="token punctuation">,</span>
			<span class="token string">"took"</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span><span class="token function">Since</span><span class="token punctuation">(</span>begin<span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	output<span class="token punctuation">,</span> err <span class="token operator">=</span> m<span class="token punctuation">.</span>next<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
	<span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="wiring-the-middleware">Wiring the Middleware<a aria-hidden="true" class="anchor-heading icon-link" href="#wiring-the-middleware"></a></h2>
<p>In order to wire the middleware in all we have to do is link it up with the service that we have defined</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"context"</span>
	<span class="token string">"encoding/json"</span>
	<span class="token string">"net/http"</span>
	<span class="token string">"os"</span>

	<span class="token string">"github.com/go-kit/kit/log"</span>

	httptransport <span class="token string">"github.com/go-kit/kit/transport/http"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// Use the global logger</span>
	logger <span class="token operator">:=</span> log<span class="token punctuation">.</span><span class="token function">NewLogfmtLogger</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>Stderr<span class="token punctuation">)</span>
	<span class="token keyword">var</span> svc PbService
	svc <span class="token operator">=</span> <span class="token function">NewPbService</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment">// Wire the middleware and thats it</span>
	svc <span class="token operator">=</span> loggingMiddleware<span class="token punctuation">{</span>logger<span class="token punctuation">,</span> svc<span class="token punctuation">}</span>

	createPbHandler <span class="token operator">:=</span> httptransport<span class="token punctuation">.</span><span class="token function">NewServer</span><span class="token punctuation">(</span>
		<span class="token function">createPbEndpoint</span><span class="token punctuation">(</span>svc<span class="token punctuation">)</span><span class="token punctuation">,</span>
		decodeCreatePbRequest<span class="token punctuation">,</span>
		encodeResponse<span class="token punctuation">,</span>
	<span class="token punctuation">)</span>

	deletePbHandler <span class="token operator">:=</span> httptransport<span class="token punctuation">.</span><span class="token function">NewServer</span><span class="token punctuation">(</span>
		<span class="token function">deletePbEndpoint</span><span class="token punctuation">(</span>svc<span class="token punctuation">)</span><span class="token punctuation">,</span>
		decodeDeletePbRequest<span class="token punctuation">,</span>
		encodeResponse<span class="token punctuation">,</span>
	<span class="token punctuation">)</span>

	getPbHandler <span class="token operator">:=</span> httptransport<span class="token punctuation">.</span><span class="token function">NewServer</span><span class="token punctuation">(</span>
		<span class="token function">getPbEndpoint</span><span class="token punctuation">(</span>svc<span class="token punctuation">)</span><span class="token punctuation">,</span>
		decodeGetPbRequest<span class="token punctuation">,</span>
		encodeResponse<span class="token punctuation">,</span>
	<span class="token punctuation">)</span>
	http<span class="token punctuation">.</span><span class="token function">Handle</span><span class="token punctuation">(</span><span class="token string">"/create"</span><span class="token punctuation">,</span> createPbHandler<span class="token punctuation">)</span>
	http<span class="token punctuation">.</span><span class="token function">Handle</span><span class="token punctuation">(</span><span class="token string">"/delete"</span><span class="token punctuation">,</span> deletePbHandler<span class="token punctuation">)</span>
	http<span class="token punctuation">.</span><span class="token function">Handle</span><span class="token punctuation">(</span><span class="token string">"/get"</span><span class="token punctuation">,</span> getPbHandler<span class="token punctuation">)</span>
	logger<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"msg"</span><span class="token punctuation">,</span> <span class="token string">"HTTP"</span><span class="token punctuation">,</span> <span class="token string">"addr"</span><span class="token punctuation">,</span> <span class="token string">":8080"</span><span class="token punctuation">)</span>
	logger<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"err"</span><span class="token punctuation">,</span> http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">encodeResponse</span><span class="token punctuation">(</span><span class="token boolean">_</span> context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> response <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> json<span class="token punctuation">.</span><span class="token function">NewEncoder</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Encode</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="pastebin">PasteBin<a aria-hidden="true" class="anchor-heading icon-link" href="#pastebin"></a></h2>
<h3 id="client">Client<a aria-hidden="true" class="anchor-heading icon-link" href="#client"></a></h3>
<pre class="language-sh"><code class="language-sh">
$ curl localhost:8080/create -XPOST -d '{"content":"THIS IS SPARTA"}'

{"key":"c449250a-d74c-4d23-acbb-6785b0bd822a"}

$ curl localhost:8080/get -XPOST -d '{"key":"c449250a-d74c-4d23-acbb-6785b0bd822a"}'

{"content":"THIS IS SPARTA"}

$ curl localhost:8I00/delete -XPOST -d '{"key":"c449250a-d74c-4d23-acbb-6785b0bd822a"}'

{"status":"ok"}

$ curl localhost:8080/get -XPOST -d '{"key":"c449250a-d74c-4d23-acbb-6785b0bd822a"}'

{"content":"","err":"Invalid Uuid"}

</code></pre>
<h3 id="server">Server<a aria-hidden="true" class="anchor-heading icon-link" href="#server"></a></h3>
<pre class="language-sh"><code class="language-sh">$ ./pastebin-II

msg=HTTP addr=:8080

method=CreatePb input="THIS IS SPARTA" output=c449250a-d74c-4d23-acbb-6785b0bd822a err=null took=67.92µs

method=GetPb input=c449250a-d74c-4d23-acbb-6785b0bd822a output="THIS IS SPARTA" err=null took=1.675µs

method=DeletePb input=c449250a-d74c-4d23-acbb-6785b0bd822a output=ok err=null took=1.45µs

method=GetPb input=c449250a-d74c-4d23-acbb-6785b0bd822a output= err="Invalid Uuid" took=803ns
</code></pre></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#gokit" title="Gokit">Gokit</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#service-layer" title="Service Layer">Service Layer</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#endpoint-layer" title="Endpoint Layer">Endpoint Layer</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#transport-layer" title="Transport Layer">Transport Layer</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#building-a-pastebin-clone" title="Building a pastebin clone">Building a pastebin clone</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#define-a-service-blueprint-interface" title="Define a service blueprint interface">Define a service blueprint interface</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#make-a-new-struct-to-define-the-pastebin-service" title="Make a new struct to define the PasteBin Service">Make a new struct to define the PasteBin Service</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#implement-the-pbservice-interface-on-the-struct" title="Implement the PbService Interface on the struct">Implement the PbService Interface on the struct</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#request-and-response" title="Request and Response">Request and Response</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#create-request-response" title="Create Request Response">Create Request Response</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#delete-request-response" title="Delete Request Response">Delete Request Response</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#get-request-response" title="Get Request Response">Get Request Response</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#define-endpoints" title="Define Endpoints">Define Endpoints</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#create-endpoint" title="Create Endpoint">Create Endpoint</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#delete-endpoint" title="Delete Endpoint">Delete Endpoint</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#get-endpoint" title="Get Endpoint">Get Endpoint</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#define-transport" title="Define Transport">Define Transport</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#create-requester-decoder" title="Create Requester Decoder">Create Requester Decoder</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#delete-request-decoder" title="Delete Request Decoder">Delete Request Decoder</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#get-request-decoder" title="Get Request Decoder">Get Request Decoder</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#response-encoder" title="Response Encoder">Response Encoder</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#main" title="Main">Main</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#divide-and-conquer" title="Divide and Conquer">Divide and Conquer</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#servicego" title="service.go">service.go</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#transportgo" title="transport.go">transport.go</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#maingo" title="main.go">main.go</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#logging-middleware" title="Logging Middleware">Logging Middleware</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#create" title="Create">Create</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#delete" title="Delete">Delete</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#get" title="Get">Get</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#wiring-the-middleware" title="Wiring the Middleware">Wiring the Middleware</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#pastebin" title="PasteBin">PasteBin</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#client" title="Client">Client</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#server" title="Server">Server</a></div></div></div></div></div></div></div></div></div></div></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></main></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"QNZTT1U9ZBung828xTuQz","title":"Gokit","desc":"","updated":1602916175130,"created":1602916175130,"stub":false,"custom":{"stub":false},"fname":"go.framework.gokit","type":"note","vault":{"fsPath":"vault"},"contentHash":"c1fb02ab62834b987f344ad920a36b47","links":[{"type":"wiki","from":{"fname":"go.framework.gokit","id":"QNZTT1U9ZBung828xTuQz","vaultName":"vault"},"value":"go","position":{"start":{"line":3,"column":32,"offset":41},"end":{"line":3,"column":38,"offset":47},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"go"}},{"type":"wiki","from":{"fname":"go.framework.gokit","id":"QNZTT1U9ZBung828xTuQz","vaultName":"vault"},"value":"go","position":{"start":{"line":56,"column":4,"offset":1175},"end":{"line":56,"column":10,"offset":1181},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"go"}}],"anchors":{"gokit":{"type":"header","text":"Gokit","value":"gokit","line":8,"column":0,"depth":2},"service-layer":{"type":"header","text":"Service Layer","value":"service-layer","line":12,"column":0,"depth":2},"endpoint-layer":{"type":"header","text":"Endpoint Layer","value":"endpoint-layer","line":19,"column":0,"depth":2},"transport-layer":{"type":"header","text":"Transport Layer","value":"transport-layer","line":25,"column":0,"depth":2},"building-a-pastebin-clone":{"type":"header","text":"Building a pastebin clone","value":"building-a-pastebin-clone","line":31,"column":0,"depth":1},"define-a-service-blueprint-interface":{"type":"header","text":"Define a service blueprint interface","value":"define-a-service-blueprint-interface","line":33,"column":0,"depth":2},"make-a-new-struct-to-define-the-pastebin-service":{"type":"header","text":"Make a new struct to define the PasteBin Service","value":"make-a-new-struct-to-define-the-pastebin-service","line":44,"column":0,"depth":2},"implement-the-pbservice-interface-on-the-struct":{"type":"header","text":"Implement the PbService Interface on the struct","value":"implement-the-pbservice-interface-on-the-struct","line":61,"column":0,"depth":2},"request-and-response":{"type":"header","text":"Request and Response","value":"request-and-response","line":101,"column":0,"depth":2},"create-request-response":{"type":"header","text":"Create Request Response","value":"create-request-response","line":107,"column":0,"depth":3},"delete-request-response":{"type":"header","text":"Delete Request Response","value":"delete-request-response","line":120,"column":0,"depth":3},"get-request-response":{"type":"header","text":"Get Request Response","value":"get-request-response","line":133,"column":0,"depth":3},"define-endpoints":{"type":"header","text":"Define Endpoints","value":"define-endpoints","line":146,"column":0,"depth":2},"create-endpoint":{"type":"header","text":"Create Endpoint","value":"create-endpoint","line":150,"column":0,"depth":3},"delete-endpoint":{"type":"header","text":"Delete Endpoint","value":"delete-endpoint","line":165,"column":0,"depth":3},"get-endpoint":{"type":"header","text":"Get Endpoint","value":"get-endpoint","line":180,"column":0,"depth":3},"define-transport":{"type":"header","text":"Define Transport","value":"define-transport","line":195,"column":0,"depth":2},"create-requester-decoder":{"type":"header","text":"Create Requester Decoder","value":"create-requester-decoder","line":199,"column":0,"depth":3},"delete-request-decoder":{"type":"header","text":"Delete Request Decoder","value":"delete-request-decoder","line":211,"column":0,"depth":3},"get-request-decoder":{"type":"header","text":"Get Request Decoder","value":"get-request-decoder","line":223,"column":0,"depth":3},"response-encoder":{"type":"header","text":"Response Encoder","value":"response-encoder","line":235,"column":0,"depth":3},"main":{"type":"header","text":"Main","value":"main","line":245,"column":0,"depth":2},"divide-and-conquer":{"type":"header","text":"Divide and Conquer","value":"divide-and-conquer","line":288,"column":0,"depth":2},"servicego":{"type":"header","text":"service.go","value":"servicego","line":292,"column":0,"depth":3},"transportgo":{"type":"header","text":"transport.go","value":"transportgo","line":353,"column":0,"depth":3},"maingo":{"type":"header","text":"main.go","value":"maingo","line":451,"column":0,"depth":3},"logging-middleware":{"type":"header","text":"Logging Middleware","value":"logging-middleware","line":479,"column":0,"depth":2},"create":{"type":"header","text":"Create","value":"create","line":496,"column":0,"depth":3},"delete":{"type":"header","text":"Delete","value":"delete","line":515,"column":0,"depth":3},"get":{"type":"header","text":"Get","value":"get","line":533,"column":0,"depth":3},"wiring-the-middleware":{"type":"header","text":"Wiring the Middleware","value":"wiring-the-middleware","line":551,"column":0,"depth":2},"pastebin":{"type":"header","text":"PasteBin","value":"pastebin","line":606,"column":0,"depth":2},"client":{"type":"header","text":"Client","value":"client","line":608,"column":0,"depth":3},"server":{"type":"header","text":"Server","value":"server","line":630,"column":0,"depth":3}},"children":[],"parent":"OmHkA6xzHAPClubvCFwQt","data":{}},"body":"\u003ch1 id=\"gokit\"\u003eGokit\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#gokit\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003ch2 id=\"gokit-1\"\u003eGokit\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#gokit-1\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eSpring boot like framework for \u003ca href=\"/notes/96Hj5nYpnUciwlTenFpoU\"\u003eGo\u003c/a\u003e. It has 3 major Components\u003c/p\u003e\n\u003ch2 id=\"service-layer\"\u003eService Layer\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#service-layer\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eInnermost layer where business logic resides.\u003c/li\u003e\n\u003cli\u003eModeled as services\u003c/li\u003e\n\u003cli\u003eOblivious to Endpoint/Transport Layers\u003c/li\u003e\n\u003cli\u003eCan be used by multiple Transports (grpc/json/http)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"endpoint-layer\"\u003eEndpoint Layer\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#endpoint-layer\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eRepresents a single RPC Method\u003c/li\u003e\n\u003cli\u003eService exposed as an Endpoint\u003c/li\u003e\n\u003cli\u003eEndpoint can be exposed by multiple Transports\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"transport-layer\"\u003eTransport Layer\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#transport-layer\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eExposes various Transports\n\u003cul\u003e\n\u003cli\u003egrpc\u003c/li\u003e\n\u003cli\u003ehttp\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"building-a-pastebin-clone\"\u003eBuilding a \u003ccode\u003epastebin\u003c/code\u003e clone\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#building-a-pastebin-clone\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003ch2 id=\"define-a-service-blueprint-interface\"\u003eDefine a service blueprint interface\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#define-a-service-blueprint-interface\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e\u003cspan class=\"token comment\"\u003e// PbService provides storage capabilities\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e PbService \u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token function\"\u003eCreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003econtent \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ctx context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token function\"\u003eDelete\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ekey \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ctx context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token function\"\u003eGet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ekey \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ctx context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"make-a-new-struct-to-define-the-pastebin-service\"\u003eMake a new struct to define the PasteBin Service\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#make-a-new-struct-to-define-the-pastebin-service\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eThis struct is used to group together the functionalities of pastebin service\u003c/p\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e\u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e pbService \u003cspan class=\"token keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tmemory \u003cspan class=\"token keyword\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003euuid\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eUUID\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// NewPbService make a new PbService\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token function\"\u003eNewPbService\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e PbService \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e pbService\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\tmemory\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token function\"\u003emake\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003euuid\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eUUID\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"implement-the-pbservice-interface-on-the-struct\"\u003eImplement the PbService Interface on the struct\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#implement-the-pbservice-interface-on-the-struct\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eIn \u003ca href=\"/notes/96Hj5nYpnUciwlTenFpoU\"\u003eGo\u003c/a\u003e we do not have a key word to define that this structs implements a specific interface like the \u003ccode\u003eimplements\u003c/code\u003e in Java.\u003c/p\u003e\n\u003cp\u003eThey way we enforce contracts is by implementing all the methods of the contract interface in our case here its the \u003ccode\u003ePbService\u003c/code\u003e interface.\u003c/p\u003e\n\u003cp\u003eSince our \u003ccode\u003eNewPbService\u003c/code\u003e method returns the type of \u003ccode\u003ePbService\u003c/code\u003e the go compiler will ensure that \u003ccode\u003eNewPbService\u003c/code\u003e confirms to the \u003ccode\u003ePbService\u003c/code\u003e interface.\u003c/p\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e\u003cspan class=\"token comment\"\u003e//Create: Here we store the content and return a uuid\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003es pbService\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token function\"\u003eCreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e content \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tid \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e uuid\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNew\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\ts\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ememory\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eid\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e content\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e id\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eString\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e//Delete: Here we use the key to find and delete the content stored\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003es pbService\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token function\"\u003eDelete\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e key \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tid\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e uuid\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eParse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ekey\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e!=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e errors\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNew\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Invalid Uuid Format\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\t\u003cspan class=\"token function\"\u003edelete\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003es\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ememory\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e id\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"ok\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e//Get: Here we use the key to find and return the content stored\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003es pbService\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token function\"\u003eGet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e key \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tid\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e uuid\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eParse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ekey\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e!=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e errors\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNew\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Invalid Uuid Format\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\tcontent\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e exists \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e s\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ememory\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eid\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e exists \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e content\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e errors\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNew\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Invalid Uuid\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"request-and-response\"\u003eRequest and Response\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#request-and-response\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eIn Go kit, the primary messaging pattern is RPC.\u003c/p\u003e\n\u003cp\u003eSo, every method in our interface will be modeled as a remote procedure call. For each method, we define request and response structs, capturing all of the input and output parameters respectively.\u003c/p\u003e\n\u003ch3 id=\"create-request-response\"\u003eCreate Request Response\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#create-request-response\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e\u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e createPbRequest \u003cspan class=\"token keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tcontent \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token string\"\u003e`json:\"content\"`\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e createPbResponse \u003cspan class=\"token keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tkey \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token string\"\u003e`json:\"key\"`\u003c/span\u003e\n\tErr \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token string\"\u003e`json:\"err,omitempty\"`\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// errors don't JSON-marshal, so we use a string\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"delete-request-response\"\u003eDelete Request Response\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#delete-request-response\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e\u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e deletePbRequest \u003cspan class=\"token keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tkey \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token string\"\u003e`json:\"key\"`\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e deletePbResponse \u003cspan class=\"token keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tstatus \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token string\"\u003e`json:\"status\"`\u003c/span\u003e\n\tErr    \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token string\"\u003e`json:\"err,omitempty\"`\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// errors don't JSON-marshal, so we use a string\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"get-request-response\"\u003eGet Request Response\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#get-request-response\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e\u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e getPbRequest \u003cspan class=\"token keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tkey \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token string\"\u003e`json:\"key\"`\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e getPbResponse \u003cspan class=\"token keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tcontent \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token string\"\u003e`json:\"content\"`\u003c/span\u003e\n\tErr     \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token string\"\u003e`json:\"err,omitempty\"`\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// errors don't JSON-marshal, so we use a string\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"define-endpoints\"\u003eDefine Endpoints\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#define-endpoints\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eAn endpoint represents a single RPC, which is a single method in our service.\u003c/p\u003e\n\u003ch3 id=\"create-endpoint\"\u003eCreate Endpoint\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#create-endpoint\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreatePbEndpoint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esvc PbService\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e endpoint\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eEndpoint \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e request \u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\treq \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e request\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecreatePbRequest\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\tkey\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e svc\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eCreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e req\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e!=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e createPbResponse\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003ekey\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eError\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\t\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e createPbResponse\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003ekey\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"delete-endpoint\"\u003eDelete Endpoint\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#delete-endpoint\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token function\"\u003edeletePbEndpoint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esvc PbService\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e endpoint\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eEndpoint \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e request \u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\treq \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e request\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edeletePbRequest\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\tstatus\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e svc\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eDelete\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e req\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eKey\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e!=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e deletePbResponse\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003estatus\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eError\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\t\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e deletePbResponse\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003estatus\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"get-endpoint\"\u003eGet Endpoint\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#get-endpoint\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token function\"\u003egetPbEndpoint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esvc PbService\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e endpoint\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eEndpoint \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e request \u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\treq \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e request\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003egetPbRequest\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\tcontent\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e svc\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eGet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e req\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eKey\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e!=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e getPbResponse\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003econtent\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eError\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\t\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e getPbResponse\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003econtent\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"define-transport\"\u003eDefine Transport\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#define-transport\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eSince this trivial example used JSON over HTTP we would have to decode the JSON to structs that our service can understand\u003c/p\u003e\n\u003ch3 id=\"create-requester-decoder\"\u003eCreate Requester Decoder\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#create-requester-decoder\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token function\"\u003edecodeCreatePbRequest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token boolean\"\u003e_\u003c/span\u003e context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e r \u003cspan class=\"token operator\"\u003e*\u003c/span\u003ehttp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eRequest\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e request createPbRequest\n\t\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e json\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNewDecoder\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003er\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eBody\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eDecode\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x26;\u003c/span\u003erequest\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e!=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e request\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"delete-request-decoder\"\u003eDelete Request Decoder\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#delete-request-decoder\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token function\"\u003edecodeDeletePbRequest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token boolean\"\u003e_\u003c/span\u003e context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e r \u003cspan class=\"token operator\"\u003e*\u003c/span\u003ehttp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eRequest\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e request deletePbRequest\n\t\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e json\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNewDecoder\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003er\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eBody\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eDecode\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x26;\u003c/span\u003erequest\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e!=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e request\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"get-request-decoder\"\u003eGet Request Decoder\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#get-request-decoder\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token function\"\u003edecodeGetPbRequest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token boolean\"\u003e_\u003c/span\u003e context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e r \u003cspan class=\"token operator\"\u003e*\u003c/span\u003ehttp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eRequest\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e request getPbRequest\n\t\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e json\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNewDecoder\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003er\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eBody\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eDecode\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x26;\u003c/span\u003erequest\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e!=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e request\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"response-encoder\"\u003eResponse Encoder\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#response-encoder\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThis method would accept an \u003ccode\u003einterface\u003c/code\u003e type and convert it JSON, this allows it to accept \u003ccode\u003ecreatePbResponse\u003c/code\u003e,\u003ccode\u003edeletePbResponse\u003c/code\u003e,\u003ccode\u003egetPbResponse\u003c/code\u003e as an \u003ccode\u003einterface{}\u003c/code\u003e and encode it as json using the annotations in the struct definition.\u003c/p\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token function\"\u003eencodeResponse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token boolean\"\u003e_\u003c/span\u003e context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e w http\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eResponseWriter\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e response \u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e json\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNewEncoder\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ew\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eEncode\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresponse\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"main\"\u003eMain\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#main\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n\t\u003cspan class=\"token string\"\u003e\"context\"\u003c/span\u003e\n\t\u003cspan class=\"token string\"\u003e\"encoding/json\"\u003c/span\u003e\n\t\u003cspan class=\"token string\"\u003e\"errors\"\u003c/span\u003e\n\t\u003cspan class=\"token string\"\u003e\"log\"\u003c/span\u003e\n\t\u003cspan class=\"token string\"\u003e\"net/http\"\u003c/span\u003e\n\n\t\u003cspan class=\"token string\"\u003e\"github.com/go-kit/kit/endpoint\"\u003c/span\u003e\n\t\u003cspan class=\"token string\"\u003e\"github.com/google/uuid\"\u003c/span\u003e\n\n\thttptransport \u003cspan class=\"token string\"\u003e\"github.com/go-kit/kit/transport/http\"\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token function\"\u003emain\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tsvc \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e \u003cspan class=\"token function\"\u003eNewPbService\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\tcreatePbHandler \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e httptransport\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNewServer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n\t\t\u003cspan class=\"token function\"\u003ecreatePbEndpoint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esvc\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\tdecodeCreatePbRequest\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\tencodeResponse\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\tdeletePbHandler \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e httptransport\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNewServer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n\t\t\u003cspan class=\"token function\"\u003edeletePbEndpoint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esvc\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\tdecodeDeletePbRequest\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\tencodeResponse\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\tgetPbHandler \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e httptransport\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNewServer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n\t\t\u003cspan class=\"token function\"\u003egetPbEndpoint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esvc\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\tdecodeGetPbRequest\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\tencodeResponse\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\thttp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eHandle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"/create\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e createPbHandler\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\thttp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eHandle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"/delete\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e deletePbHandler\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\thttp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eHandle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"/get\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e getPbHandler\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\tlog\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eFatal\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ehttp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eListenAndServe\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\":8080\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"divide-and-conquer\"\u003eDivide and Conquer\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#divide-and-conquer\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eAt this point the \u003ccode\u003emain.go\u003c/code\u003e has a lot of code so lets move to different files so that we have separation of concerns.\u003c/p\u003e\n\u003ch3 id=\"servicego\"\u003e\u003ccode\u003eservice.go\u003c/code\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#servicego\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e\u003cspan class=\"token keyword\"\u003epackage\u003c/span\u003e main\n\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n\t\u003cspan class=\"token string\"\u003e\"context\"\u003c/span\u003e\n\t\u003cspan class=\"token string\"\u003e\"errors\"\u003c/span\u003e\n\n\t\u003cspan class=\"token string\"\u003e\"github.com/google/uuid\"\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// PbService provides storage capabilities\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e PbService \u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token function\"\u003eCreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e content \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token function\"\u003eDelete\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e key \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token function\"\u003eGet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e key \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e pbService \u003cspan class=\"token keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tmemory \u003cspan class=\"token keyword\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003euuid\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eUUID\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// NewPbService make a new PbService\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token function\"\u003eNewPbService\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e PbService \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e pbService\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\tmemory\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token function\"\u003emake\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003euuid\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eUUID\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e//Create: Here we store the content and return a uuid\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003es pbService\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token function\"\u003eCreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e content \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tid \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e uuid\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNew\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\ts\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ememory\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eid\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e content\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e id\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eString\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e//Get: Here we use the key to find and return the content stored\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003es pbService\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token function\"\u003eGet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e key \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tid\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e uuid\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eParse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ekey\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e!=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e errors\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNew\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Invalid Uuid Format\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\tcontent\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e exists \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e s\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ememory\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eid\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e exists \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e content\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e errors\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNew\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Invalid Uuid\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e//Delete: Here we use the key to find and delete the content stored\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003es pbService\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token function\"\u003eDelete\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e key \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tid\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e uuid\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eParse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ekey\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e!=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e errors\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNew\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Invalid Uuid Format\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\t\u003cspan class=\"token function\"\u003edelete\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003es\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ememory\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e id\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"ok\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"transportgo\"\u003e\u003ccode\u003etransport.go\u003c/code\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#transportgo\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e\u003cspan class=\"token keyword\"\u003epackage\u003c/span\u003e main\n\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n\t\u003cspan class=\"token string\"\u003e\"context\"\u003c/span\u003e\n\t\u003cspan class=\"token string\"\u003e\"encoding/json\"\u003c/span\u003e\n\t\u003cspan class=\"token string\"\u003e\"net/http\"\u003c/span\u003e\n\n\t\u003cspan class=\"token string\"\u003e\"github.com/go-kit/kit/endpoint\"\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e createPbRequest \u003cspan class=\"token keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tContent \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token string\"\u003e`json:\"content\"`\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e createPbResponse \u003cspan class=\"token keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tKey \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token string\"\u003e`json:\"key\"`\u003c/span\u003e\n\tErr \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token string\"\u003e`json:\"err,omitempty\"`\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// errors don't JSON-marshal, so we use a string\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e getPbRequest \u003cspan class=\"token keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tKey \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token string\"\u003e`json:\"key\"`\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e getPbResponse \u003cspan class=\"token keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tContent \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token string\"\u003e`json:\"content\"`\u003c/span\u003e\n\tErr     \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token string\"\u003e`json:\"err,omitempty\"`\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// errors don't JSON-marshal, so we use a string\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e deletePbRequest \u003cspan class=\"token keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tKey \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token string\"\u003e`json:\"key\"`\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e deletePbResponse \u003cspan class=\"token keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tStatus \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token string\"\u003e`json:\"status\"`\u003c/span\u003e\n\tErr    \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token string\"\u003e`json:\"err,omitempty\"`\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// errors don't JSON-marshal, so we use a string\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreatePbEndpoint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esvc PbService\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e endpoint\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eEndpoint \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e request \u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\treq \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e request\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecreatePbRequest\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\tkey\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e svc\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eCreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e req\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e!=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e createPbResponse\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003ekey\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eError\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\t\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e createPbResponse\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003ekey\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token function\"\u003edeletePbEndpoint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esvc PbService\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e endpoint\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eEndpoint \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e request \u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\treq \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e request\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edeletePbRequest\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\tstatus\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e svc\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eDelete\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e req\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eKey\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e!=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e deletePbResponse\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003estatus\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eError\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\t\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e deletePbResponse\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003estatus\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token function\"\u003egetPbEndpoint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esvc PbService\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e endpoint\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eEndpoint \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e request \u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\treq \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e request\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003egetPbRequest\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\tcontent\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e svc\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eGet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e req\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eKey\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e!=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e getPbResponse\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003econtent\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eError\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\t\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e getPbResponse\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003econtent\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token function\"\u003edecodeCreatePbRequest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token boolean\"\u003e_\u003c/span\u003e context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e r \u003cspan class=\"token operator\"\u003e*\u003c/span\u003ehttp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eRequest\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e request createPbRequest\n\t\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e json\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNewDecoder\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003er\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eBody\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eDecode\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x26;\u003c/span\u003erequest\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e!=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e request\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token function\"\u003edecodeGetPbRequest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token boolean\"\u003e_\u003c/span\u003e context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e r \u003cspan class=\"token operator\"\u003e*\u003c/span\u003ehttp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eRequest\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e request getPbRequest\n\t\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e json\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNewDecoder\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003er\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eBody\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eDecode\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x26;\u003c/span\u003erequest\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e!=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e request\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token function\"\u003edecodeDeletePbRequest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token boolean\"\u003e_\u003c/span\u003e context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e r \u003cspan class=\"token operator\"\u003e*\u003c/span\u003ehttp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eRequest\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e request deletePbRequest\n\t\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e json\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNewDecoder\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003er\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eBody\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eDecode\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x26;\u003c/span\u003erequest\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e!=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e request\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"maingo\"\u003e\u003ccode\u003emain.go\u003c/code\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#maingo\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token function\"\u003emain\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tsvc \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e \u003cspan class=\"token function\"\u003eNewPbService\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\tcreatePbHandler \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e httptransport\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNewServer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n\t\t\u003cspan class=\"token function\"\u003ecreatePbEndpoint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esvc\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\tdecodeCreatePbRequest\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\tencodeResponse\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\tdeletePbHandler \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e httptransport\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNewServer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n\t\t\u003cspan class=\"token function\"\u003edeletePbEndpoint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esvc\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\tdecodeDeletePbRequest\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\tencodeResponse\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\tgetPbHandler \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e httptransport\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNewServer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n\t\t\u003cspan class=\"token function\"\u003egetPbEndpoint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esvc\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\tdecodeGetPbRequest\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\tencodeResponse\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\thttp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eHandle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"/create\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e createPbHandler\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\thttp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eHandle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"/delete\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e deletePbHandler\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\thttp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eHandle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"/get\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e getPbHandler\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\tlog\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eFatal\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ehttp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eListenAndServe\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\":8080\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"logging-middleware\"\u003eLogging Middleware\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#logging-middleware\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eAll applications need to log information, this can be enabled by adding a logging middleware that we create in a file called \u003ccode\u003elogging.go\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eMiddleware in go-kit work on \u003ccode\u003eEndpoint\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eThe interface definition is \u003ccode\u003etype Middleware func(Endpoint) Endpoint\u003c/code\u003e, which means it is a function that takes in an endpoint and returns an endpoint\u003c/p\u003e\n\u003cp\u003eWe can create the \u003ccode\u003eloggingMiddleware\u003c/code\u003e so that it adheres to the \u003ccode\u003ePbService\u003c/code\u003e by implementing the \u003ccode\u003eCreate\u003c/code\u003e \u003ccode\u003eDelete\u003c/code\u003e \u003ccode\u003eGet\u003c/code\u003e methods.\u003c/p\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e\u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e loggingMiddleware \u003cspan class=\"token keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\tlogger log\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eLogger\n\tnext   PbService\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"create\"\u003eCreate\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#create\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003em loggingMiddleware\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token function\"\u003eCreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e content \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eoutput \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token comment\"\u003e// This defered function would be invoked just before the retuen statement\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003edefer\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ebegin time\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eTime\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\tm\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elogger\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eLog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n\t\t\t\u003cspan class=\"token string\"\u003e\"method\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"CreatePb\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\t\t\u003cspan class=\"token string\"\u003e\"input\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e content\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\t\t\u003cspan class=\"token string\"\u003e\"output\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e output\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\t\t\u003cspan class=\"token string\"\u003e\"err\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\t\t\u003cspan class=\"token string\"\u003e\"took\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e time\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eSince\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ebegin\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\t\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etime\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\toutput\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e m\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003enext\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eCreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e content\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"delete\"\u003eDelete\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#delete\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e \u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003em loggingMiddleware\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token function\"\u003eDelete\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e key \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eoutput \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003edefer\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ebegin time\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eTime\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\tm\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elogger\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eLog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n\t\t\t\u003cspan class=\"token string\"\u003e\"method\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"DeletePb\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\t\t\u003cspan class=\"token string\"\u003e\"input\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e key\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\t\t\u003cspan class=\"token string\"\u003e\"output\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e output\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\t\t\u003cspan class=\"token string\"\u003e\"err\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\t\t\u003cspan class=\"token string\"\u003e\"took\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e time\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eSince\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ebegin\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\t\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etime\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\toutput\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e m\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003enext\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eDelete\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e key\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"get\"\u003eGet\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#get\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003em loggingMiddleware\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token function\"\u003eGet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e key \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eoutput \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003edefer\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ebegin time\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eTime\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\tm\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elogger\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eLog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n\t\t\t\u003cspan class=\"token string\"\u003e\"method\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"GetPb\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\t\t\u003cspan class=\"token string\"\u003e\"input\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e key\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\t\t\u003cspan class=\"token string\"\u003e\"output\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e output\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\t\t\u003cspan class=\"token string\"\u003e\"err\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\t\t\u003cspan class=\"token string\"\u003e\"took\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e time\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eSince\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ebegin\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\t\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etime\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\toutput\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e m\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003enext\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eGet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ectx\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e key\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"wiring-the-middleware\"\u003eWiring the Middleware\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#wiring-the-middleware\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eIn order to wire the middleware in all we have to do is link it up with the service that we have defined\u003c/p\u003e\n\u003cpre class=\"language-go\"\u003e\u003ccode class=\"language-go\"\u003e\u003cspan class=\"token keyword\"\u003epackage\u003c/span\u003e main\n\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n\t\u003cspan class=\"token string\"\u003e\"context\"\u003c/span\u003e\n\t\u003cspan class=\"token string\"\u003e\"encoding/json\"\u003c/span\u003e\n\t\u003cspan class=\"token string\"\u003e\"net/http\"\u003c/span\u003e\n\t\u003cspan class=\"token string\"\u003e\"os\"\u003c/span\u003e\n\n\t\u003cspan class=\"token string\"\u003e\"github.com/go-kit/kit/log\"\u003c/span\u003e\n\n\thttptransport \u003cspan class=\"token string\"\u003e\"github.com/go-kit/kit/transport/http\"\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token function\"\u003emain\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token comment\"\u003e// Use the global logger\u003c/span\u003e\n\tlogger \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e log\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNewLogfmtLogger\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eos\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eStderr\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e svc PbService\n\tsvc \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003eNewPbService\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"token comment\"\u003e// Wire the middleware and thats it\u003c/span\u003e\n\tsvc \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e loggingMiddleware\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003elogger\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e svc\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\tcreatePbHandler \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e httptransport\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNewServer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n\t\t\u003cspan class=\"token function\"\u003ecreatePbEndpoint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esvc\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\tdecodeCreatePbRequest\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\tencodeResponse\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\tdeletePbHandler \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e httptransport\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNewServer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n\t\t\u003cspan class=\"token function\"\u003edeletePbEndpoint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esvc\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\tdecodeDeletePbRequest\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\tencodeResponse\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\tgetPbHandler \u003cspan class=\"token operator\"\u003e:=\u003c/span\u003e httptransport\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNewServer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n\t\t\u003cspan class=\"token function\"\u003egetPbEndpoint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esvc\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\tdecodeGetPbRequest\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\tencodeResponse\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\thttp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eHandle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"/create\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e createPbHandler\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\thttp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eHandle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"/delete\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e deletePbHandler\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\thttp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eHandle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"/get\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e getPbHandler\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\tlogger\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eLog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"msg\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"HTTP\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"addr\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\":8080\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\tlogger\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eLog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"err\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e http\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eListenAndServe\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\":8080\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enil\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003efunc\u003c/span\u003e \u003cspan class=\"token function\"\u003eencodeResponse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token boolean\"\u003e_\u003c/span\u003e context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContext\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e w http\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eResponseWriter\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e response \u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eerror\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e json\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eNewEncoder\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ew\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eEncode\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresponse\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"pastebin\"\u003ePasteBin\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#pastebin\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"client\"\u003eClient\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#client\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre class=\"language-sh\"\u003e\u003ccode class=\"language-sh\"\u003e\n$ curl localhost:8080/create -XPOST -d '{\"content\":\"THIS IS SPARTA\"}'\n\n{\"key\":\"c449250a-d74c-4d23-acbb-6785b0bd822a\"}\n\n$ curl localhost:8080/get -XPOST -d '{\"key\":\"c449250a-d74c-4d23-acbb-6785b0bd822a\"}'\n\n{\"content\":\"THIS IS SPARTA\"}\n\n$ curl localhost:8I00/delete -XPOST -d '{\"key\":\"c449250a-d74c-4d23-acbb-6785b0bd822a\"}'\n\n{\"status\":\"ok\"}\n\n$ curl localhost:8080/get -XPOST -d '{\"key\":\"c449250a-d74c-4d23-acbb-6785b0bd822a\"}'\n\n{\"content\":\"\",\"err\":\"Invalid Uuid\"}\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"server\"\u003eServer\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#server\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre class=\"language-sh\"\u003e\u003ccode class=\"language-sh\"\u003e$ ./pastebin-II\n\nmsg=HTTP addr=:8080\n\nmethod=CreatePb input=\"THIS IS SPARTA\" output=c449250a-d74c-4d23-acbb-6785b0bd822a err=null took=67.92µs\n\nmethod=GetPb input=c449250a-d74c-4d23-acbb-6785b0bd822a output=\"THIS IS SPARTA\" err=null took=1.675µs\n\nmethod=DeletePb input=c449250a-d74c-4d23-acbb-6785b0bd822a output=ok err=null took=1.45µs\n\nmethod=GetPb input=c449250a-d74c-4d23-acbb-6785b0bd822a output= err=\"Invalid Uuid\" took=803ns\n\u003c/code\u003e\u003c/pre\u003e","noteIndex":{"id":"root","title":"BrainMatter","desc":"","updated":1668313955403,"created":1602915435296,"stub":false,"nav_order":0,"custom":{"stub":false,"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"7b584540f5ff09a7953c66d95b7ee329","links":[],"anchors":{},"children":["ovOjtfOpF3vhfFUZi6DHp","3dNch4I3rcDy5xXFn3R6B","BWzIJm01jQ6aNNg56CwnS","96Hj5nYpnUciwlTenFpoU","6Wl0i0BjF7yD85uM5RTyK","o3yahkxofd7qighsrvpg893","7kyCk8YAkDvIrxLtAUFkG","A6TBKYAcFVjBqZpdbHuaS","w3B0c1Y72MfzhwoVNx7vx","t6ilpq115sipjv378ambtkv"],"parent":null,"data":{},"body":"\n\n![DeltaManiac](https://raw.githubusercontent.com/DeltaManiac/DeltaManiac/main/vault/assets/banner.svg)\n\n- 🔭 I’m currently playing Destiny 2\n- 🌱 I’m currently learning [Rust](https://www.rust-lang.org) at night and [Go](https://golang.org/) at work\n- 📫 How to reach me: [twitter](https://twitter.com/Delta_Maniac)\n- 😄 Pronouns: He/Him\n\u003c!-- - ⚡ Fun fact: The banner was provided by [Pushkar Anand](https://github.com/pushkar8723) sourced from [Responsive Cow Jumps Over the Moooooon](https://codepen.io/sdras/pen/doZReX) --\u003e\n\u003c!-- // - 👯 I’m looking to collaborate on ...\n// - 🤔 I’m looking for help with ...\n// - 💬 Ask me about ... --\u003e\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":false,"leaveTrace":false,"bubbleUpCreateNew":true,"vaultSelectionModeOnCreate":"smart","fuzzThreshold":0.2}},"randomNote":{},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"dendronVersion":"0.83.0","vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":true,"maxPreviewsCached":10,"maxNoteLength":204800,"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"enableUserTags":true,"enableHashTags":true,"enableEditorDecorations":true,"enableFullHierarchyNoteTitle":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"automaticallyShowPreview":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":true,"siteRootDir":"docs","seo":{"title":"BrainMatter","description":"Personal knowledge space","author":"DeltaManiac","twitter":"delta_maniac"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree","editRepository":"https://github.com/DeltaManiac/deltamaniac.github.io"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"lookup","siteUrl":"https://deltamaniac.github.io/","hierarchy":{"root":{"publishByDefault":true}},"siteFaviconPath":"favicon.ico","siteIndex":"root"},"generateChangelog":true}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"QNZTT1U9ZBung828xTuQz"},"buildId":"uwaFLQSct0mTPwxN4Nqr7","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>